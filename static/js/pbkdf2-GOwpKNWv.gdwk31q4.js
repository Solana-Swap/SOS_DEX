import{bs as I,bt as P,bu as F,bv as A,bw as L,bx as h,N as R}from"./Bridge.lzhc31h3.js";function g(u,y,d,l){F(u);const b=A({dkLen:32,asyncTick:10},l),{c:f,dkLen:i,asyncTick:t}=b;if(L(f),L(i),L(t),f<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const n=h(y),o=h(d),r=new Uint8Array(i),p=R.create(u,n),e=p._cloneInto().update(o);return{c:f,dkLen:i,asyncTick:t,DK:r,PRF:p,PRFSalt:e}}function _(u,y,d,l,b){return u.destroy(),y.destroy(),l&&l.destroy(),b.fill(0),d}function S(u,y,d,l){const{c:b,dkLen:f,DK:i,PRF:t,PRFSalt:n}=g(u,y,d,l);let o;const r=new Uint8Array(4),p=I(r),e=new Uint8Array(t.outputLen);for(let s=1,k=0;k<f;s++,k+=t.outputLen){const a=i.subarray(k,k+t.outputLen);p.setInt32(0,s,!1),(o=n._cloneInto(o)).update(r).digestInto(e),a.set(e.subarray(0,a.length));for(let w=1;w<b;w++){t._cloneInto(o).update(e).digestInto(e);for(let c=0;c<a.length;c++)a[c]^=e[c]}}return _(t,n,i,o,e)}async function T(u,y,d,l){const{c:b,dkLen:f,asyncTick:i,DK:t,PRF:n,PRFSalt:o}=g(u,y,d,l);let r;const p=new Uint8Array(4),e=I(p),s=new Uint8Array(n.outputLen);for(let k=1,a=0;a<f;k++,a+=n.outputLen){const w=t.subarray(a,a+n.outputLen);e.setInt32(0,k,!1),(r=o._cloneInto(r)).update(p).digestInto(s),w.set(s.subarray(0,w.length)),await P(b-1,i,()=>{n._cloneInto(r).update(s).digestInto(s);for(let c=0;c<w.length;c++)w[c]^=s[c]})}return _(n,o,t,r,s)}const m=Object.freeze(Object.defineProperty({__proto__:null,pbkdf2:S,pbkdf2Async:T},Symbol.toStringTag,{value:"Module"}));export{m as S,S as T};
